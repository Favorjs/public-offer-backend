// schema.prisma - Updated
generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model AdminUsers {
  email      String   @unique
  password   String
  created_at DateTime @default(now())

  @@map("admin_users")
}

model PublicOffer {
  id                 Int          @id @default(autoincrement())
  date               DateTime     @default(now())
  shares_applied     BigInt
  amount_payable     BigInt
  account_type       AccountType
  title              Title
  title_others       String?      @db.VarChar(50)
  surname            String
  first_name         String
  other_names        String?
  address            String
  city               String
  state              String
  country            String       @default("Nigeria")
  phone              String
  email              String
  dob                DateTime
  next_of_kin        String
  contact_person     String
  chn                String
  cscs_no            String
  stockbroker        Stockbrokers @relation(fields: [stockbrokers_id], references: [id])
  stockbrokers_id    Int
  stockbrokers_code  String?
  name               String? // For corporate/joint applications
  designation        String? // For corporate/joint applications
  second_name        String? // For joint applications
  second_designation String? // For joint applications
  rc_number          String? // For corporate applications
  bank_name          String?
  bvn                String?
  account_number     String?
  branch             String?
  bank_city          String?

  // Signature fields
  individual_signature String? // For individual applications
  corporate_signature  String? // For corporate applications  
  joint_signature      String? // For joint applications

  // Evidence of payment (upload)
  payment_receipt          String? @db.Text
  payment_receipt_filename String? @db.VarChar(255)
  payment_receipt_mime     String? @db.VarChar(100)

  status     ApplicationStatus @default(PENDING)
  created_at DateTime          @default(now())
  updated_at DateTime          @updatedAt

  @@map("public_offers")
}

model Stockbrokers {
  id            Int           @id @default(autoincrement())
  name          String
  code          String
  public_offers PublicOffer[]

  @@map("stockbrokers")
}

enum Title {
  MR
  MRS
  MISS
  OTHERS
}

enum AccountType {
  INDIVIDUAL
  CORPORATE
  JOINT
}

enum ApplicationStatus {
  PENDING
  SUBMITTED
  APPROVED
  REJECTED
}
